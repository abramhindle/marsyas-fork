<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Marsyas: /home/hindle1/src/marsyas/src/marsyas/MarSystem.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Marsyas
   &#160;<span id="projectnumber">0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_6680c0e66a1a8ddee45eaed69a14f44a.html">marsyas</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MarSystem.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">** Copyright (C) 1998-2010 George Tzanetakis &lt;gtzan@cs.uvic.ca&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">**</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">** This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">** it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">** the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">** (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">**</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">** This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">** but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">** GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">**</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">** You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">** along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="common__source_8h.html">common_source.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;MarSystem.h&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;MarControlManager.h&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;EvValUpd.h&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;TmVirtualTime.h&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">using</span> std::ostringstream;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">using</span> std::cout;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">using</span> std::endl;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using</span> std::vector;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">using</span> std::pair;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">using</span> std::map;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">using</span> std::istream;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">using</span> std::ostream;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using namespace </span>Marsyas;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;MarSystem::MarSystem(mrs_string type, mrs_string name)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a> = NULL;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a4d739cc5d335052eb9f5b2ca559b81d1" title="Name of instance.">name_</a> = name;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> = type;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    active_ = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> = <span class="stringliteral">&quot;/&quot;</span> + <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> + <span class="stringliteral">&quot;/&quot;</span> + <a class="code" href="classMarsyas_1_1MarSystem.html#a4d739cc5d335052eb9f5b2ca559b81d1" title="Name of instance.">name_</a> + <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a> = <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    inObservations_ = 0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    inSamples_ = 0;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    onObservations_ = 0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    onSamples_ = 0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    osrate_ = 0.0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    israte_ = 0.0;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    inStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    onStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    tonSamples_ = 0;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    tonObservations_ = 0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    tinSamples_ = 0;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    tinObservations_ = 0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    tosrate_ = 0.0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    tisrate_ = 0.0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    tinStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    tonStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    tonObsNames_ = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    onObsNames_ = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    addToStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    isComposite_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    marsystemsSize_ = 0;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    MATLABscript_ = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#ac04358674719dc8eaacbe9786f53b8a3" title="value which is added to inStabilizingDelay to produce onStabilizingDelay. Defaults to 0...">isUpdating_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">//add default controls that</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">//all MarSystems should have</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    addControls();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    scheduler_.removeAll();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="classMarsyas_1_1TmTimer.html" title="Base timer class must be overriden to create new concrete timers.">TmTimer</a>* t = <span class="keyword">new</span> <a class="code" href="classMarsyas_1_1TmVirtualTime.html" title="TmVirtualTime reads the insamples information to advance the timer.">TmVirtualTime</a>(<span class="stringliteral">&quot;Virtual&quot;</span>,<span class="keyword">this</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    scheduler_.addTimer(t);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// copy constructor</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;MarSystem::MarSystem(<span class="keyword">const</span> <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>&amp; a)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a> = NULL;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> = a.<a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    name_ = a.<a class="code" href="classMarsyas_1_1MarSystem.html#a4d739cc5d335052eb9f5b2ca559b81d1" title="Name of instance.">name_</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> = a.<a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a> = a.<a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    active_ = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    osrate_ = 0.0;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    inObservations_ = 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    onObservations_ = 0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    inSamples_ = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    israte_ = 0.0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    inStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    onStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    onSamples_ = 0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    tonObsNames_ = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    onObsNames_ = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    tonSamples_ = 0;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    tonObservations_ = 0;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    tinSamples_ = 0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    tinObservations_ = 0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    tosrate_ = 0.0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    tisrate_ = 0.0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    tinStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    tonStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    addToStabilizingDelay_ = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    MATLABscript_ = a.MATLABscript_;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#ac04358674719dc8eaacbe9786f53b8a3" title="value which is added to inStabilizingDelay to produce onStabilizingDelay. Defaults to 0...">isUpdating_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">//clone controls (cloned controls will have no links! - they have to be relinked as done below)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.clear();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">for</span> (ctrlIter_ = a.<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.begin(); ctrlIter_ != a.<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end(); ++ctrlIter_)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="comment">//clone all controls</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[ctrlIter_-&gt;first] = ctrlIter_-&gt;second-&gt;clone();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="comment">//set new MarSystem parent</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[ctrlIter_-&gt;first]-&gt;setMarSystem(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">//update the &quot;references&quot; to the controls</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    ctrl_inSamples_ = getctrl(<span class="stringliteral">&quot;mrs_natural/inSamples&quot;</span>);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    ctrl_inObservations_ = getctrl(<span class="stringliteral">&quot;mrs_natural/inObservations&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    ctrl_israte_ = getctrl(<span class="stringliteral">&quot;mrs_real/israte&quot;</span>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    ctrl_inObsNames_ = getctrl(<span class="stringliteral">&quot;mrs_string/inObsNames&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    ctrl_onSamples_ = getctrl(<span class="stringliteral">&quot;mrs_natural/onSamples&quot;</span>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    ctrl_onObservations_ = getctrl(<span class="stringliteral">&quot;mrs_natural/onObservations&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    ctrl_osrate_ = getctrl(<span class="stringliteral">&quot;mrs_real/osrate&quot;</span>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    ctrl_onObsNames_ = getctrl(<span class="stringliteral">&quot;mrs_string/onObsNames&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    ctrl_debug_ = getctrl(<span class="stringliteral">&quot;mrs_bool/debug&quot;</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    ctrl_verbose_ = getctrl(<span class="stringliteral">&quot;mrs_bool/verbose&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    ctrl_mute_ = getctrl(<span class="stringliteral">&quot;mrs_bool/mute&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    ctrl_active_ = getctrl(<span class="stringliteral">&quot;mrs_bool/active&quot;</span>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    ctrl_processedData_ = getctrl(<span class="stringliteral">&quot;mrs_realvec/processedData&quot;</span>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    ctrl_inStabilizingDelay_ = getctrl(<span class="stringliteral">&quot;mrs_natural/inStabilizingDelay&quot;</span>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    ctrl_onStabilizingDelay_ = getctrl(<span class="stringliteral">&quot;mrs_natural/onStabilizingDelay&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">//clone children (if any) =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    isComposite_ = a.isComposite_;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    marsystemsSize_ = 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt; a.marsystemsSize_; ++i)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>* clonedChild = (*a.<a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]).clone();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            addMarSystem(clonedChild);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            clonedChild-&gt;relinkControls((*a.<a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    this-&gt;relinkControls(a);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">//  // &quot;re-link&quot; controls  =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">//  for(ctrlIter_ = a.controls_.begin(); ctrlIter_ != a.controls_.end(); ++ctrlIter_)</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">//  {</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//      // get original links...</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">//      vector&lt;pair&lt;MarControlPtr, MarControlPtr&gt; &gt; originalLinks = ctrlIter_-&gt;second-&gt;getLinks();</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">//      // ...clear clone&#39;s links...</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">//      //controls_[ctrlIter_-&gt;first]-&gt;unlinkFromAll(); //[?] is this really necessary?</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">//      //... and re-establish links between the new cloned controls</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">//      vector&lt;pair&lt;MarControlPtr, MarControlPtr&gt; &gt;::const_iterator linksIter;</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">//      for (linksIter = originalLinks.begin(); linksIter != originalLinks.end(); ++linksIter)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">//      {</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">//          //ignore the root link (not important for relinking)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">//          if(linksIter-&gt;first() == linksIter-&gt;second())</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">//              continue;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">//          //check if this control links to someone, and link them accordingly...</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">//          if(linksIter-&gt;first() == ctrlIter_-&gt;second())</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">//              MarControlPtr ctrl2Link2 = this-&gt;getControl(linksIter-&gt;second-&gt;getMarSystem()-&gt;getAbsPath() + linksIter-&gt;second-&gt;getName(), true);</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">//              //controls from siblings may not exist yet at this time, so we must not try to link</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">//              //to their yet invalid controls. Just link with controls from</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">//              //the parent or already existing siblings and children. The remaining ones will be linked</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">//              //by the siblings when they get created.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">//              if (!ctrl2Link2.isInvalid())</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">//              {</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">//                  controls_[ctrlIter_-&gt;first]-&gt;linkTo(ctrl2Link2);</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">//              }</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">//          //...or check if someone links to this control, and link them accordingly</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">//          else if(linksIter-&gt;second() == ctrlIter_-&gt;second())</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">//          {</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">//              MarControlPtr linkedCtrl = this-&gt;getControl(linksIter-&gt;first-&gt;getMarSystem()-&gt;getAbsPath() + linksIter-&gt;first-&gt;getName(), true);</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">//              //controls from siblings may not exist yet at this time, so we must not try to link</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">//              //to their yet invalid controls. Just link with controls from</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">//              //the parent or already existing siblings and children. The remaining ones will be linked</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">//              //by the siblings when they get created.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//              if (!linkedCtrl.isInvalid())</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">//              {</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">//                  linkedCtrl-&gt;linkTo(controls_[ctrlIter_-&gt;first]);</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">//              }</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">//recreate schedule objects  =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    scheduler_.removeAll();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classMarsyas_1_1TmTimer.html" title="Base timer class must be overriden to create new concrete timers.">TmTimer</a>* t = <span class="keyword">new</span> <a class="code" href="classMarsyas_1_1TmVirtualTime.html" title="TmVirtualTime reads the insamples information to advance the timer.">TmVirtualTime</a>(<span class="stringliteral">&quot;Virtual&quot;</span>,<span class="keyword">this</span>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    scheduler_.addTimer(t);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;MarSystem::relinkControls(<span class="keyword">const</span> <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>&amp; a)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// &quot;re-link&quot; controls  =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">for</span> (ctrlIter_ = a.<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.begin(); ctrlIter_ != a.<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end(); ++ctrlIter_)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">// get original links...</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        vector&lt;pair&lt;MarControlPtr, MarControlPtr&gt; &gt; originalLinks = ctrlIter_-&gt;second-&gt;getLinks();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">// ...clear clone&#39;s links...</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="comment">//controls_[ctrlIter_-&gt;first]-&gt;unlinkFromAll(); //[?] is this really necessary?</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">//... and re-establish links between the new cloned controls</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        vector&lt;pair&lt;MarControlPtr, MarControlPtr&gt; &gt;::const_iterator linksIter;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">for</span> (linksIter = originalLinks.begin(); linksIter != originalLinks.end(); ++linksIter)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">//ignore the root link (not important for relinking)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">if</span> (linksIter-&gt;first() == linksIter-&gt;second())</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="comment">//check if this control links to someone, and link them accordingly...</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> (linksIter-&gt;first() == ctrlIter_-&gt;second())</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                MarControlPtr ctrl2Link2 = this-&gt;getControl(linksIter-&gt;second-&gt;getMarSystem()-&gt;getAbsPath() + linksIter-&gt;second-&gt;getName(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="comment">//controls from siblings may not exist yet at this time, so we must not try to link</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="comment">//to their yet invalid controls. Just link with controls from</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="comment">//the parent or already existing siblings and children. The remaining ones will be linked</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="comment">//by the siblings when they get created.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keywordflow">if</span> (!ctrl2Link2.isInvalid())</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[ctrlIter_-&gt;first]-&gt;linkTo(ctrl2Link2);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">//...or check if someone links to this control, and link them accordingly</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (linksIter-&gt;second() == ctrlIter_-&gt;second())</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                MarControlPtr linkedCtrl = this-&gt;getControl(linksIter-&gt;first-&gt;getMarSystem()-&gt;getAbsPath() + linksIter-&gt;first-&gt;getName(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="comment">//controls from siblings may not exist yet at this time, so we must not try to link</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <span class="comment">//to their yet invalid controls. Just link with controls from</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="comment">//the parent or already existing siblings and children. The remaining ones will be linked</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="comment">//by the siblings when they get created.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">if</span> (!linkedCtrl.isInvalid())</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    linkedCtrl-&gt;linkTo(<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[ctrlIter_-&gt;first]);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;MarSystem::~MarSystem()</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">//delete children (if any)</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">for</span> (mrs_natural i=0; i&lt; marsystemsSize_; ++i)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i];</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;MarSystem::addControls()</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;{</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">//input pin controls (with state)</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_natural/inSamples&quot;</span>, MRS_DEFAULT_SLICE_NSAMPLES, ctrl_inSamples_);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    setctrlState(ctrl_inSamples_, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_natural/inObservations&quot;</span>, MRS_DEFAULT_SLICE_NOBSERVATIONS, ctrl_inObservations_);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    setctrlState(ctrl_inObservations_, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_real/israte&quot;</span>, MRS_DEFAULT_SLICE_SRATE, ctrl_israte_);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    setctrlState(ctrl_israte_, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_string/inObsNames&quot;</span>, <span class="stringliteral">&quot;,&quot;</span>, ctrl_inObsNames_);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    setctrlState(ctrl_inObsNames_, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_natural/inStabilizingDelay&quot;</span>, 0, ctrl_inStabilizingDelay_);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    setctrlState(ctrl_inStabilizingDelay_, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//output pin controls (stateless)</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_natural/onSamples&quot;</span>, MRS_DEFAULT_SLICE_NSAMPLES, ctrl_onSamples_);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_natural/onObservations&quot;</span>, MRS_DEFAULT_SLICE_NOBSERVATIONS, ctrl_onObservations_);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_real/osrate&quot;</span>, MRS_DEFAULT_SLICE_SRATE, ctrl_osrate_);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_string/onObsNames&quot;</span>, <span class="stringliteral">&quot;,&quot;</span>, ctrl_onObsNames_);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_natural/onStabilizingDelay&quot;</span>, 0, ctrl_onStabilizingDelay_);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    setctrlState(ctrl_onStabilizingDelay_, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    inObservations_ = ctrl_inObservations_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    inSamples_ = ctrl_inSamples_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    inStabilizingDelay_ = ctrl_inStabilizingDelay_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    onObservations_ = ctrl_onObservations_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    onSamples_ = ctrl_onSamples_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    onStabilizingDelay_ = ctrl_onStabilizingDelay_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">//other controls:</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_bool/debug&quot;</span>, <span class="keyword">false</span>, ctrl_debug_);      <span class="comment">//no debug by default</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_bool/verbose&quot;</span>, <span class="keyword">false</span>, ctrl_verbose_);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_bool/mute&quot;</span>, <span class="keyword">false</span>, ctrl_mute_);            <span class="comment">//unmuted by default</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_bool/active&quot;</span>,<span class="keyword">true</span>, ctrl_active_);      <span class="comment">//active by default</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    inTick_.create(inObservations_, inSamples_);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    outTick_.create(onObservations_, onSamples_);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    addctrl(<span class="stringliteral">&quot;mrs_realvec/processedData&quot;</span>, outTick_, ctrl_processedData_);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    ctrl_active_-&gt;setState(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    active_ = ctrl_active_-&gt;to&lt;<span class="keywordtype">bool</span>&gt;();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;}</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;MarSystem::addMarSystem(<a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a> *marsystem)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">//idiot proof 1</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> == marsystem)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::addMarSystem - Trying to add MarSystem to itself - failing...&quot;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (marsystem == NULL)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::addMarSystem - Adding a NULL MarSystem - failing...&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">//idiot proof 2</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>* msys = <a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">while</span> (msys)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span> (msys == marsystem)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            MRSWARN(<span class="stringliteral">&quot;MarSystem::addMarSystem - Trying to add an ancestor MarSystem as a child - failing...&quot;</span>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        msys = msys-&gt;<a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//it&#39;s only possible to add MarSystems to Composites</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        vector&lt;MarSystem*&gt;::iterator it;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordtype">bool</span> replaced = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">//check if a child MarSystem with the same type/name</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">//exists. If it does, replace it with the new one.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">for</span> (it = <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.begin(); it != <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.end(); ++it)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordflow">if</span> ((*it)-&gt;getName() == marsystem-&gt;getName() &amp;&amp;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                (*it)-&gt;getType() == marsystem-&gt;getType())</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="comment">//delete current child MarSystem</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keyword">delete</span> (*it);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="comment">//and replace it with the new one</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                (*it) = marsystem;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                replaced = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">//if no replacement took place, then add the</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="comment">//new MarSystem as a new child</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">if</span> (!replaced)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.push_back(marsystem);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            marsystemsSize_ = (mrs_natural)<a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.size();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">//set parent for the new child MarSystem</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        marsystem-&gt;setParent(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="comment">//update child MarSystem</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">//marsystem-&gt;update(); //superfluous update call! It will be called by this-&gt;update() [!]</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">//update parent MarSystem</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        update();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::addMarSystem - Trying to add MarSystem to a non-Composite - failing...&quot;</span>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>*</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;MarSystem::getChildMarSystem(std::string childPath)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">//check for an absolute path, and if necessary convert it</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">//to a relative path</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span> (childPath[0] == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">//is this absolute path pointing to this MarSystem?  =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">if</span> (childPath.substr(0, <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.length()) == <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="comment">//return control path without the absolute path</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="comment">//(i.e. return the relative path)</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            childPath = childPath.substr(<a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.length(), childPath.length());</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="comment">//this absolute path does not point to this MarSystem or any of its</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="comment">//children...</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            MRSWARN(<span class="stringliteral">&quot;MarSystem::getChildMarSystem: &quot;</span> + childPath + <span class="stringliteral">&quot; is an invalid path @ &quot;</span> + <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//from this point, childPath is for sure a relative path.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">//start by checking if childPath is not empty (or resulted from an absolute</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">//path pointing to this MarSystem itself and not to any of its children)</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (childPath == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::getChildMarSystem: path does not point to a child MarSystem&quot;</span>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">//...otherwise, search among its children... =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        vector&lt;MarSystem*&gt;::const_iterator msysIter;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">for</span> (msysIter = <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.begin(); msysIter != <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.end(); ++msysIter)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            mrs_string prefix = (*msysIter)-&gt;getPrefix();</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            prefix = prefix.substr(1, prefix.length()-2); <span class="comment">//ignore leading and trailing &quot;/&quot;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">if</span> (childPath.substr(0, prefix.length()) == prefix)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="comment">//a matching child was found!</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="keywordflow">if</span> (childPath.length() == prefix.length())</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    <span class="keywordflow">return</span> (*msysIter);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="comment">//The prefix may be the same, but we still need to check that the next char is a /</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                <span class="comment">// Otherwise in the case of system Sys1, and Sys10, it will appear that Sys10 is the child Sys1</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (childPath.length() &gt; prefix.length() &amp;&amp; childPath.substr(prefix.length() , 1) == <span class="stringliteral">&quot;/&quot;</span>)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    <span class="comment">//remove parent prefix from childPath, and continue searching recursively in children</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    childPath = childPath.substr(prefix.length()+1,childPath.length());</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    <span class="keywordflow">return</span> (*msysIter)-&gt;getChildMarSystem(childPath);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::getChildMarsystem(): &quot;</span> + childPath + <span class="stringliteral">&quot; not found!&quot;</span>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::getChildMarsystem(): &quot;</span> + childPath + <span class="stringliteral">&quot; not found!&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;MarSystem::setParent(<span class="keyword">const</span> <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>* parent) <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;{</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a> = <span class="keyword">const_cast&lt;</span><a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>*<span class="keyword">&gt;</span>(parent);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// Update our path, and propogate changes to children (if applicable)</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    updatePath();</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00474"></a><span class="lineno"><a class="code" href="classMarsyas_1_1MarSystem.html#adb901a4b43e2cea8e9b55547365f5caf">  474</a></span>&#160;<a class="code" href="classMarsyas_1_1MarSystem.html#adb901a4b43e2cea8e9b55547365f5caf" title="Naming methods.">MarSystem::setName</a>(mrs_string name) <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;{</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (name == name_)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    mrs_string oldPrefix = <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> = <span class="stringliteral">&quot;/&quot;</span> + <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> + <span class="stringliteral">&quot;/&quot;</span> + name + <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    name_ = name;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">//update path accordingly</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    mrs_string::size_type pos = <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.find(oldPrefix, 0);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    mrs_string uppath = <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.substr(0, pos);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    mrs_string downpath = <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.substr(oldPrefix.length()+pos, <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.length()-(oldPrefix.length()+pos));</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a> = uppath + <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> + downpath;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;marsystemsSize_; ++i)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;updatePath();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;MarSystem::setType(mrs_string type) <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;{</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">if</span> (type == <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a>)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    mrs_string oldPrefix = <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> = <span class="stringliteral">&quot;/&quot;</span> + type + <span class="stringliteral">&quot;/&quot;</span> + name_ + <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> = type;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">//update path accordingly</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    mrs_string::size_type pos = <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.find_last_of(oldPrefix, 0);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    mrs_string uppath = <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.substr(0, pos);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    mrs_string downpath = <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.substr(oldPrefix.length()+pos, <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.length()-(oldPrefix.length()+pos));</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a> = uppath + <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> + downpath;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;marsystemsSize_; ++i)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;updatePath();</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;}</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;mrs_string</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;MarSystem::getType() const <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;mrs_string</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;MarSystem::getName() const <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;{</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#a4d739cc5d335052eb9f5b2ca559b81d1" title="Name of instance.">name_</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;mrs_string</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;MarSystem::getPrefix() const <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;{</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;mrs_string</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;MarSystem::getAbsPath() const <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;{</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;MarSystem::updatePath() <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;{</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a> = <a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>-&gt;getAbsPath() + <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> + <span class="charliteral">&#39;/&#39;</span> + name_ + <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a> = <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">//propagate new path to all children (if any)</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt; marsystemsSize_; ++i)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;updatePath();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;MarSystem::checkFlow(realvec&amp; in, realvec&amp; out)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;{</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    irows_ = in.getRows();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    icols_ = in.getCols();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    orows_ = out.getRows();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    ocols_ = out.getCols();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span> (ctrl_debug_-&gt;isTrue())</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        MRSWARN(<span class="stringliteral">&quot;Debug CheckFlow Information&quot;</span>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem Type    = &quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem Name    = &quot;</span> &lt;&lt; name_);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        MRSWARN(<span class="stringliteral">&quot;inObservAtions_ = &quot;</span> &lt;&lt; inObservations_);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        MRSWARN(<span class="stringliteral">&quot;inSamples_ = &quot;</span> &lt;&lt; inSamples_);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        MRSWARN(<span class="stringliteral">&quot;onObservations_ = &quot;</span> &lt;&lt; onObservations_);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        MRSWARN(<span class="stringliteral">&quot;onSamples_ = &quot;</span> &lt;&lt; onSamples_);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        MRSWARN(<span class="stringliteral">&quot;inStabilizingDelay_ = &quot;</span> &lt;&lt; inStabilizingDelay_);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        MRSWARN(<span class="stringliteral">&quot;onStabilizingDelay_ = &quot;</span> &lt;&lt; onStabilizingDelay_);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        MRSWARN(<span class="stringliteral">&quot;Input  Slice Rows = &quot;</span> &lt;&lt; irows_ );</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        MRSWARN(<span class="stringliteral">&quot;Input  Slice Cols = &quot;</span> &lt;&lt; icols_ );</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        MRSWARN(<span class="stringliteral">&quot;Output Slice Rows = &quot;</span> &lt;&lt; orows_ );</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        MRSWARN(<span class="stringliteral">&quot;Output Slice Cols = &quot;</span> &lt;&lt; ocols_ );</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    MRSASSERT(irows_ == inObservations_);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    MRSASSERT(icols_ == inSamples_);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    MRSASSERT(orows_ == onObservations_);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    MRSASSERT(ocols_ == onSamples_);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;}</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;MarSystem::process(realvec&amp; in, realvec&amp; out)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;{</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    MRSDIAG(<a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; name_ &lt;&lt; <span class="stringliteral">&quot;::process&quot;</span>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">#ifdef MARSYAS_FLOWCHECK</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="preprocessor"></span>    checkFlow(in, out);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    myProcess(in, out);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="preprocessor">#ifdef MARSYAS_MATLAB</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (!MATLABscript_.empty())</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        MATLAB_PUT(in, name_ + <span class="stringliteral">&quot;_in&quot;</span>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        MATLAB_PUT(out, name_ + <span class="stringliteral">&quot;_out&quot;</span>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        MATLAB_EVAL(MATLABscript_);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        MATLAB_GET(name_+<span class="stringliteral">&quot;_out&quot;</span>, out);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">//check if out realvec was shortened by MATLAB script... //[!]</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">if</span> ((out.getRows() &lt; onObservations_)||(out.getCols() &lt; onSamples_))</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            out.stretch(onObservations_, onSamples_);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;MarSystem::tick()</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;{</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="comment">//if MarSystem is not active, ignore ticks</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (ctrl_active_-&gt;isTrue())</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        scheduler_.tick();</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            MarControlAccessor acc(ctrl_processedData_);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            realvec&amp; processedData = acc.to&lt;mrs_realvec&gt;();</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            process(inTick_, processedData);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        MRSDIAG(<span class="stringliteral">&quot;MarSystem::tick() : MarSystem is not active! Ignoring tick command.&quot;</span>);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        (void)42;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;}</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;MarSystem::myUpdate(MarControlPtr sender)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;{</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    (void) sender;  <span class="comment">//suppress warning of unused parameter(s)</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    MRSDIAG(<span class="stringliteral">&quot;MarSystem.cpp - MarSystem:myUpdate&quot;</span>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">//lmartins:</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">//By default, a MarSystem does not modify the input data stream format.</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">//Override this method on a derived MarSystem if data format changes</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">//should take place...</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">//forward flow propagation</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    ctrl_onSamples_-&gt;setValue(ctrl_inSamples_, NOUPDATE);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    ctrl_onObservations_-&gt;setValue(ctrl_inObservations_, NOUPDATE);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    ctrl_osrate_-&gt;setValue(ctrl_israte_, NOUPDATE);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    ctrl_onObsNames_-&gt;setValue(ctrl_inObsNames_, NOUPDATE);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;MarSystem::isUpdating()</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#ac04358674719dc8eaacbe9786f53b8a3" title="value which is added to inStabilizingDelay to produce onStabilizingDelay. Defaults to 0...">isUpdating_</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;MarSystem::update(MarControlPtr sender)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;{</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    MRSDIAG(<a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; name_ &lt;&lt; <span class="stringliteral">&quot;::update&quot;</span>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#ac04358674719dc8eaacbe9786f53b8a3" title="value which is added to inStabilizingDelay to produce onStabilizingDelay. Defaults to 0...">isUpdating_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">//store current flow variables</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    tinObservations_ = inObservations_;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    tinSamples_ = inSamples_;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    tisrate_ = israte_;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    tinObsNames_ = inObsNames_;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    tonObservations_ = onObservations_;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    tonSamples_ = onSamples_;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    tosrate_ = osrate_;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    tonObsNames_ = onObsNames_;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    tinStabilizingDelay_ = inStabilizingDelay_;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    tonStabilizingDelay_ = onStabilizingDelay_;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">//sync input member variables</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    inObservations_ = ctrl_inObservations_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    inSamples_ = ctrl_inSamples_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    israte_ = ctrl_israte_-&gt;to&lt;mrs_real&gt;();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    inObsNames_ = ctrl_inObsNames_-&gt;to&lt;mrs_string&gt;();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    inStabilizingDelay_ = ctrl_inStabilizingDelay_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">//sync output member variables</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    onObservations_ = ctrl_onObservations_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    onSamples_ = ctrl_onSamples_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    osrate_ = ctrl_osrate_-&gt;to&lt;mrs_real&gt;();</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    onObsNames_ = ctrl_onObsNames_-&gt;to&lt;mrs_string&gt;();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    onStabilizingDelay_ = ctrl_onStabilizingDelay_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">// do this before myUpdate() in case it needs to be</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">// overridden, i.e. for a Composite</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    ctrl_onStabilizingDelay_-&gt;setValue(</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        ctrl_inStabilizingDelay_-&gt;to&lt;mrs_natural&gt;()</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        + addToStabilizingDelay_, NOUPDATE);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">//call derived class specific update</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    myUpdate(sender);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">//sync input member variables</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    inObservations_ = ctrl_inObservations_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    inSamples_ = ctrl_inSamples_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    israte_ = ctrl_israte_-&gt;to&lt;mrs_real&gt;();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    inObsNames_ = ctrl_inObsNames_-&gt;to&lt;mrs_string&gt;();</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    inStabilizingDelay_ = ctrl_inStabilizingDelay_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">//sync output member variables</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    onObservations_ = ctrl_onObservations_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    onSamples_ = ctrl_onSamples_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    osrate_ = ctrl_osrate_-&gt;to&lt;mrs_real&gt;();</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    onObsNames_ = ctrl_onObsNames_-&gt;to&lt;mrs_string&gt;();</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    onStabilizingDelay_ = ctrl_onStabilizingDelay_-&gt;to&lt;mrs_natural&gt;();</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//check active status</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordtype">bool</span> active = ctrl_active_-&gt;isTrue();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">//if active status changed...</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">if</span> (active_ !=  active)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      active_ = active;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      activate(active);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">//resize input and output realvec if necessary</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">if</span> ((inObservations_ != inTick_.getRows()) ||</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        (inSamples_ != inTick_.getCols())      ||</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        (onObservations_ != outTick_.getRows()) ||</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        (onSamples_ != outTick_.getCols()))</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      inTick_.create(inObservations_, inSamples_);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        MarControlAccessor acc(ctrl_processedData_);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        realvec&amp; processedData = acc.to&lt;mrs_realvec&gt;();</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        processedData.create(onObservations_, onSamples_);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">//check for OUT-FLOW modifications without parent knowledge!!</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">if</span> (tonObservations_ != onObservations_ ||</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            tonSamples_ != onSamples_ ||</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            tosrate_ != osrate_ ||</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            tonObsNames_ != onObsNames_)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>-&gt;isUpdating())</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>-&gt;update(sender);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#ac04358674719dc8eaacbe9786f53b8a3" title="value which is added to inStabilizingDelay to produce onStabilizingDelay. Defaults to 0...">isUpdating_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;}</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;MarSystem::activate(<span class="keywordtype">bool</span> state) <span class="comment">//non-thread-safe, but this method is only supposed to be called from update(), which is thread-safe</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;{</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">//since this method must be public (so it can be called in Composite::activate())</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="comment">//we must guarantee that the &quot;mrs_bool/active&quot; control is in sync with any eventual</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">//direct calls to MarSystem::activate() from client code</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">if</span> (ctrl_active_-&gt;to&lt;<span class="keywordtype">bool</span>&gt;() != state)</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        ctrl_active_-&gt;setValue(state, NOUPDATE);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        active_ = state;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="comment">//execute any code needed to run when activating/deactivating</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">//the derived MarSystem</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    localActivate(state);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;}</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;MarSystem::localActivate(<span class="keywordtype">bool</span> state)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;{</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">//call activate for all Composite&#39;s components</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt; marsystemsSize_; ++i)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="comment">//marsystems_[i]-&gt;activate(state);</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;updControl(<span class="stringliteral">&quot;mrs_bool/active&quot;</span>, state); <span class="comment">//thread-safe</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;}</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;mrs_string</div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="code" href="classMarsyas_1_1MarSystem.html#adb485c40cd7759b028209e10661bc58f">  794</a></span>&#160;<a class="code" href="classMarsyas_1_1MarSystem.html#adb485c40cd7759b028209e10661bc58f" title="control paths">MarSystem::getControlRelativePath</a>(mrs_string cname)<span class="keyword"> const</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// If the cname starts with an &#39;/&#39;, it is an absolute path</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="comment">// that has to be made relative.</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (cname[0] == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="comment">//is this absolute path pointing to this MarSystem? // =&gt; mutexes [?]</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">if</span> (cname.substr(0, <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.length()) == <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <span class="comment">//return control path without the absolute path</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="comment">//(i.e. return the relative path)</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="keywordflow">return</span> cname.substr(<a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>.length(), cname.length());</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="comment">// cname is already a relative path, so we can return that.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">return</span> cname;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;mrs_string</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;MarSystem::getControlLocalPath(mrs_string cname)<span class="keyword"> const</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">// Convert cname to the canonical relative format.</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    cname = <a class="code" href="classMarsyas_1_1MarSystem.html#adb485c40cd7759b028209e10661bc58f" title="control paths">getControlRelativePath</a>(cname);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">if</span> (cname == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="comment">// Not a control from this MarSystem or its children.</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// A local path should have only one &#39;/&#39; (e.g. &quot;mrs_xxx/nnnn&quot;),</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// otherwise it&#39;s probably a control from a child MarSystem.</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">if</span> (cname.find_first_of(<span class="charliteral">&#39;/&#39;</span>) == cname.find_last_of(<span class="charliteral">&#39;/&#39;</span>) &amp;&amp;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        cname.find_first_of(<span class="charliteral">&#39;/&#39;</span>) != mrs_string::npos)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// This is a relative and local path, so just return it</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">return</span> cname;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="comment">// This is not a local control =&gt; return invalid name</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00846"></a><span class="lineno"><a class="code" href="classMarsyas_1_1MarSystem.html#a63f09b80ca0e7838eb2a771e0372afec">  846</a></span>&#160;<a class="code" href="classMarsyas_1_1MarSystem.html#a63f09b80ca0e7838eb2a771e0372afec" title="Link controls.">MarSystem::linkControl</a>(mrs_string cname1, mrs_string cname2, <span class="keywordtype">bool</span> update)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;{</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">//Links the control cname1 with the control cname 2.</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">//Link fails case both cname1 and cname2 point to non-existing controls.</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment">//cname1 should point to a local or child control (using an absolute control pathname,</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">//a local control pathname or a relative pathname).</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">//If control corresponding to cname1 does not exist locally or in any child,</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="comment">//a proxy control is created and added to the corresponding MarSystem.</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">//In all these cases, cname1 control will assume the current value of the cname2 control.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="comment">//cname2 should point to an existing control, anywhere in the network (i.e. not necessarily a</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">//local or a child&#39;s control).</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">//cname 2 can be a absolute, local or relative pathname.</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">//In case cname2 points to a non-existing control, if its pathname corresponds to a local or</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">//a child&#39;s control, a proxy control will be created in the corresponding MarSystem.</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">//In this case, the value of the cname2 control will be set to the current value of the cname1 control.</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">//try to get the controls</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    MarControlPtr ctrl1 = getControl(cname1, <span class="keyword">false</span>, <span class="keyword">true</span>);<span class="comment">//search local and child controls</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    MarControlPtr ctrl2 = getControl(cname2, <span class="keyword">true</span>, <span class="keyword">true</span>);<span class="comment">//search everywhere in the network (including locally, at parent and among children)</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">//a control is inherently connected to itself!</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">if</span> (ctrl1() == ctrl2())</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> (ctrl1() == NULL)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Impossible to link two non-existing controls: &quot;</span> + cname1+<span class="stringliteral">&quot; --&gt; &quot;</span>+cname2);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">//if  2nd control does not exist somewhere in the network,</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">//try to create one locally or in children (and assign it the value of the 1st control)</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">if</span> (ctrl2.isInvalid())</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="comment">//MRSWARN(&quot;MarSystem::linkControl - 2nd control does not exist anywhere: &quot; + cname2 + &quot; -&gt; THIS MAY BE NORMAL WHEN LOADING A MARSYSTEM NETWORK FROM A .mpl FILE!&quot;);</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="comment">//return false;</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        mrs_string relativecname = <a class="code" href="classMarsyas_1_1MarSystem.html#adb485c40cd7759b028209e10661bc58f" title="control paths">getControlRelativePath</a>(cname2);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        mrs_string localcname = getControlLocalPath(cname2);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="comment">//if cname2 is a local control path, add it to this MarSystem</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">if</span> (localcname != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">if</span> (!addControl(cname2, ctrl1-&gt;clone(), ctrl2))</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Error creating new proxy control &quot;</span> + cname2 + <span class="stringliteral">&quot; @ &quot;</span> + getAbsPath());</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            MRSDIAG(<span class="stringliteral">&quot;MarSystem::linkControl - Added new proxy control &quot;</span> + cname2 + <span class="stringliteral">&quot; @ &quot;</span> + getAbsPath());</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            ctrl2-&gt;setState(<span class="keyword">false</span>); <span class="comment">//proxy controls never need to have state!</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">//if cname2 is a relative path, check among children for a matching MarSystem</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="comment">//where to add the new link control</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (relativecname != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="comment">//get the MarSystem path from relativecname</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            mrs_string::size_type pos = relativecname.find(<span class="stringliteral">&quot;/mrs_&quot;</span>, 0);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            mrs_string relativepath = relativecname.substr(0, pos);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>* msys = getChildMarSystem(relativepath);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <span class="keywordflow">if</span> (msys)</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                mrs_string cname = relativecname.substr(pos+1, relativecname.length());</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <span class="keywordflow">if</span> (!msys-&gt;addControl(cname, ctrl1-&gt;clone(), ctrl2))</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Error creating new link control &quot;</span> + cname2 + <span class="stringliteral">&quot; @ &quot;</span> + msys-&gt;getAbsPath());</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                MRSDIAG(<span class="stringliteral">&quot;MarSystem::linkControl - Added new proxy control &quot;</span> + cname2 + <span class="stringliteral">&quot; @ &quot;</span> + msys-&gt;getAbsPath());</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                ctrl2-&gt;setState(<span class="keyword">false</span>); <span class="comment">//proxy controls never need to have state!</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Error creating new link control: &quot;</span> + cname2 + <span class="stringliteral">&quot; is an invalid path&quot;</span>);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">//if cname1 path is not a valid path, nor a path pointing to any of the children</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">//it is not possible to add the new link control...</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Error creating new link control: &quot;</span> + cname2 + <span class="stringliteral">&quot; is an invalid path&quot;</span>);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">//check if the first control already exists or if we have</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="comment">// to create and add it to the corresponding MarSystem</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">if</span> (ctrl1.isInvalid())</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        mrs_string relativecname = <a class="code" href="classMarsyas_1_1MarSystem.html#adb485c40cd7759b028209e10661bc58f" title="control paths">getControlRelativePath</a>(cname1);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        mrs_string localcname = getControlLocalPath(cname1);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="comment">//if cname1 is a local control path, add it to this MarSystem</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">if</span> (localcname != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            <span class="keywordflow">if</span> (!addControl(cname1, ctrl2-&gt;clone(), ctrl1))</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Error creating new link control &quot;</span> + cname1 + <span class="stringliteral">&quot; @ &quot;</span> + getAbsPath());</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            MRSDIAG(<span class="stringliteral">&quot;MarSystem::linkControl - Added new proxy control &quot;</span> + cname1 + <span class="stringliteral">&quot; @ &quot;</span> + getAbsPath());</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            ctrl1-&gt;setState(<span class="keyword">false</span>); <span class="comment">//proxy controls never need to have state!</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="comment">//if cname1 is a relative path, check among children for a matching MarSystem</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="comment">//where to add the new link control</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (relativecname != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="comment">//get the MarSystem path from relativecname</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            mrs_string::size_type pos = relativecname.find(<span class="stringliteral">&quot;/mrs_&quot;</span>, 0);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            mrs_string relativepath = relativecname.substr(0, pos);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>* msys = getChildMarSystem(relativepath);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <span class="keywordflow">if</span> (msys)</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                mrs_string cname = relativecname.substr(pos+1, relativecname.length());</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">if</span> (!msys-&gt;addControl(cname, ctrl2-&gt;clone(), ctrl1))</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Error creating new link control &quot;</span> + cname1 + <span class="stringliteral">&quot; @ &quot;</span> + msys-&gt;getAbsPath());</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                MRSDIAG(<span class="stringliteral">&quot;MarSystem::linkControl - Added new proxy control &quot;</span> + cname1 + <span class="stringliteral">&quot; @ &quot;</span> + msys-&gt;getAbsPath());</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                ctrl1-&gt;setState(<span class="keyword">false</span>); <span class="comment">//proxy controls never need to have state!</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Error creating new link control: &quot;</span> + cname1 + <span class="stringliteral">&quot;is an invalid path&quot;</span>);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="comment">//if cname1 path is not a valid path, nor a path pointing to any of the children</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="comment">//it is not possible to add the new link control...</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            MRSWARN(<span class="stringliteral">&quot;MarSystem::linkControl - Error creating new link control: &quot;</span> + cname1 + <span class="stringliteral">&quot;is an invalid path&quot;</span>);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">//now both controls exist</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">//just link them</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">return</span> ctrl1-&gt;linkTo(ctrl2, update);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;}</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;MarControlPtr</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;MarSystem::getControl(mrs_string cname, <span class="keywordtype">bool</span> searchParent, <span class="keywordtype">bool</span> searchChildren)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;{</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">//USE A CACHE FOR MORE EFFICIENT LOOK-UP?? [!]</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="comment">//convert cname to the canonical relative format</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    mrs_string relativecname = <a class="code" href="classMarsyas_1_1MarSystem.html#adb485c40cd7759b028209e10661bc58f" title="control paths">getControlRelativePath</a>(cname);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="comment">//if this is not a control from this MarSystem or its children</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">//ask parent (if allowed) to search for it on the remaining of the network</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">if</span> (relativecname == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">if</span> (searchParent &amp;&amp; <a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#a57e87c242d81ca70dbe02dd600e35434" title="Parent MarSystem (if in a composite, otherwise it&#39;s NULL)">parent_</a>-&gt;getControl(cname, <span class="keyword">true</span>, <span class="keyword">true</span>);<span class="comment">//parent will also ask its parent if necessary // =&gt; mutexes [?]</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="keywordflow">else</span> <span class="comment">//parent search not allowed, so the control was not found =&gt; return invalid control</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="comment">//MRSWARN(&quot;MarSystem::getControl - Unsupported control name: &quot; + cname + &quot; @ &quot; + absPath_ + &quot; -&gt; THIS MAY BE NORMAL DURING CLONING!&quot;);</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keywordflow">return</span> MarControlPtr();</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">//check if this relative control path points to a possible local control</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    mrs_string localcname = getControlLocalPath(relativecname);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (localcname != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="comment">//This may be a local control, so look for it</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.find(localcname) != <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end())</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[localcname]; <span class="comment">//control found</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordflow">return</span> MarControlPtr(); <span class="comment">//no control found with this name =&gt; return invalid control</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">//definitely not a local control pathname. It can only be a relative control path.</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">//So search in children (if allowed).</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <span class="keywordflow">if</span> (searchChildren)</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="comment">//search for a child that has a corresponding prefix</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            vector&lt;MarSystem*&gt;::const_iterator msysIter;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            <span class="keywordflow">for</span> (msysIter = <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.begin(); msysIter != <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.end(); ++msysIter) <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;            {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                mrs_string prefix = (*msysIter)-&gt;getPrefix();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                prefix = prefix.substr(1, prefix.length()); <span class="comment">//ignore leading &quot;/&quot;</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                <span class="keywordflow">if</span> (relativecname.substr(0, prefix.length()) == prefix)</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    <span class="comment">//a matching child was found!</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    <span class="comment">//check if the control exists in the child</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    mrs_string childcname = relativecname.substr(prefix.length(),relativecname.length());</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                    <span class="keywordflow">return</span> (*msysIter)-&gt;getControl(childcname);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            <span class="keywordflow">return</span> MarControlPtr();<span class="comment">//no child found with corresponding prefix...</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <span class="keywordflow">return</span> MarControlPtr();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;}</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;MarSystem::hasControlState(mrs_string cname)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;{</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    MarControlPtr control = getControl(cname);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span> (control.isInvalid())</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::hasControlState Unsupported control name = &quot;</span> + cname);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">return</span> control-&gt;hasState();</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;}</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;MarSystem::setControlState(mrs_string cname, <span class="keywordtype">bool</span> state)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;{</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    MarControlPtr control = getControl(cname);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="keywordflow">if</span> (control.isInvalid())</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarControls::setState Unsupported control name = &quot;</span> + cname);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        control-&gt;setState(state);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;}</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;MarSystem::hasControl(mrs_string cname, <span class="keywordtype">bool</span> searchChildren)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;{</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">//look for local and (optionally) children controls</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    MarControlPtr control = this-&gt;getControl(cname, <span class="keyword">false</span>, searchChildren);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">return</span> !control.isInvalid();</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;}</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;MarSystem::hasControl(MarControlPtr control, <span class="keywordtype">bool</span> searchChildren)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;{</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="comment">//search local controls</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">for</span> (ctrlIter_=<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.begin(); ctrlIter_!=<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end();++ctrlIter_)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordflow">if</span> ((ctrlIter_-&gt;second)() == control())</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    }</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">//search control among children (if allowed)</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span> (searchChildren)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        vector&lt;MarSystem*&gt;::const_iterator msysIter;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">for</span> (msysIter=<a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.begin(); msysIter!=<a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.end(); ++msysIter)</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="keywordflow">if</span> ((*msysIter)-&gt;hasControl(control, <span class="keyword">true</span>))</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;}</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="keywordtype">bool</span> MarSystem::updControl(<span class="keyword">const</span> <span class="keywordtype">char</span>* cname, MarControlPtr newcontrol, <span class="keywordtype">bool</span> upd)</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;{</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    MarControlPtr control = getControl(cname);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keywordflow">if</span> (control.isInvalid())</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::updControl - &quot;</span> + std::string(cname) + <span class="stringliteral">&quot; is an invalid control @ &quot;</span> + getAbsPath());</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">return</span> updControl(control, newcontrol, upd);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;}</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="keywordtype">bool</span> MarSystem::updControl(std::string cname, MarControlPtr newcontrol, <span class="keywordtype">bool</span> upd)</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;{</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    MarControlPtr control = getControl(cname);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordflow">if</span> (control.isInvalid())</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::updControl - &quot;</span> + cname + <span class="stringliteral">&quot; is an invalid control @ &quot;</span> + getAbsPath());</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    }</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keywordflow">return</span> updControl(control, newcontrol, upd);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;}</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;MarSystem::updControl(MarControlPtr control, MarControlPtr newcontrol, <span class="keywordtype">bool</span> upd)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;{</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="comment">// check if the control is valid</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">if</span> (control.isInvalid())</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::updControl - Invalid control ptr @ &quot;</span> + getAbsPath());</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordflow">if</span> (newcontrol.isInvalid())</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::updControl - Invalid control ptr given for assignment&quot;</span>);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">//  //check if control exists locally or among children</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">//  if(!hasControl(control))</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="comment">//  {</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="comment">//      MRSWARN(&quot;MarSystem::updControl - &quot; + control-&gt;getName() +&quot; @ &quot;+getAbsPath()+ &quot; does not exist locally or in children!&quot;);</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="comment">//      return false;</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">//  }</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">return</span> control-&gt;setValue(newcontrol, upd);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;}</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;MarSystem::updControl(<a class="code" href="classMarsyas_1_1EvEvent.html" title="EvEvent.">EvEvent</a>* me)</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;{</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">if</span> (me != NULL)</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        me-&gt;<a class="code" href="classMarsyas_1_1EvEvent.html#a0f109f1a95c300f1a979a9d59f2c39d4" title="the action to be performed by the event. This method is called when the event is due. Since Marsyas is not threaded, this method will block so be careful not to do too much.">dispatch</a>();</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="keyword">delete</span>(me);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;}</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;MarSystem::updControl(<a class="code" href="classMarsyas_1_1TmTime.html" title="TmTime.">TmTime</a> t, <a class="code" href="classMarsyas_1_1EvEvent.html" title="EvEvent.">EvEvent</a>* ev)</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;{</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    scheduler_.post(t,<a class="code" href="classMarsyas_1_1Repeat.html" title="encapsulates repetition information for scheduled events">Repeat</a>(),ev);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;}</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;MarSystem::updControl(<a class="code" href="classMarsyas_1_1TmTime.html" title="TmTime.">TmTime</a> t, <a class="code" href="classMarsyas_1_1Repeat.html" title="encapsulates repetition information for scheduled events">Repeat</a> r, <a class="code" href="classMarsyas_1_1EvEvent.html" title="EvEvent.">EvEvent</a>* ev)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;{</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    scheduler_.post(t,r,ev);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;}</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;MarSystem::updControl(<a class="code" href="classMarsyas_1_1TmTime.html" title="TmTime.">TmTime</a> t, mrs_string cname, MarControlPtr control)</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;{</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    scheduler_.post(t,<a class="code" href="classMarsyas_1_1Repeat.html" title="encapsulates repetition information for scheduled events">Repeat</a>(),<span class="keyword">new</span> <a class="code" href="classMarsyas_1_1EvValUpd.html" title="update a MarSystem control value">EvValUpd</a>(<span class="keyword">this</span>,cname,control));</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;}</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;MarSystem::updControl(<a class="code" href="classMarsyas_1_1TmTime.html" title="TmTime.">TmTime</a> t, <a class="code" href="classMarsyas_1_1Repeat.html" title="encapsulates repetition information for scheduled events">Repeat</a> r, mrs_string cname, MarControlPtr control)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;{</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    scheduler_.post(t,r,<span class="keyword">new</span> <a class="code" href="classMarsyas_1_1EvValUpd.html" title="update a MarSystem control value">EvValUpd</a>(<span class="keyword">this</span>,cname,control));</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;}</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">//get local controls only (i.e. no child controls included)</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="keyword">const</span> map&lt;mrs_string, MarControlPtr&gt;&amp;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;MarSystem::getLocalControls()</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;{</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;}</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">// get all the controls (including controls of children)</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">// for a particular MarSystem</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;map&lt;mrs_string, MarControlPtr&gt;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;MarSystem::getControls(map&lt;mrs_string, MarControlPtr&gt;* cmap)</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;{</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">if</span> (!cmap)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        map&lt;mrs_string, MarControlPtr&gt; controlsmap;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        cmap = &amp;controlsmap;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="comment">//fill list with local controls</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="keywordflow">for</span> (ctrlIter_=<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.begin(); ctrlIter_ != <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end(); ++ctrlIter_)</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            (*cmap)[<a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>+ctrlIter_-&gt;first] = ctrlIter_-&gt;second;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="comment">//iterate over children, recursively,</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="comment">//and fill the list with their controls</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        vector&lt;MarSystem*&gt;::const_iterator msysIter;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="keywordflow">for</span> (msysIter = <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.begin(); msysIter != <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.end(); ++msysIter)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            (*msysIter)-&gt;getControls(cmap);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">return</span> (*cmap);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    }</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        <span class="comment">//fill list with local controls</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordflow">for</span> (ctrlIter_=<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.begin(); ctrlIter_ != <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end(); ++ctrlIter_)</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            (*cmap)[<a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>+ctrlIter_-&gt;first] = ctrlIter_-&gt;second;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="comment">//iterate over children, recursively,</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="comment">//and fill the list with their controls</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        vector&lt;MarSystem*&gt;::const_iterator msysIter;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordflow">for</span> (msysIter = <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.begin(); msysIter != <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.end(); ++msysIter)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            (*msysIter)-&gt;getControls(cmap);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keywordflow">return</span> (*cmap);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    }</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;}</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;vector&lt;MarSystem*&gt;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;MarSystem::getChildren()</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;{</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;}</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;MarSystem::addControl(mrs_string cname, MarControlPtr v, MarControlPtr&amp; ptr)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;{</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span> (addControl(cname, v))</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        ptr = <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[cname]; <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        ptr = MarControlPtr();<span class="comment">//return invalid control</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;}</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;MarSystem::addControl(mrs_string cname, MarControlPtr v)</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;{</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="comment">//convert cname to the canonical local control pathname format</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    mrs_string pcname = cname;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    cname = getControlLocalPath(cname);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordflow">if</span> (cname == <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="comment">//cname is an invalid control pathname!</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::addControl - invalid control pathname: &quot;</span> + pcname);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::addControl - absolute path: &quot;</span> + <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>); <span class="comment">// =&gt; mutexes [?]</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">//check for type mismatch between cname string (which include type information)</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="comment">//and the actual control type passed as an argument</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    mrs_string::size_type pos = cname.find(<span class="stringliteral">&quot;/&quot;</span>, 0);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    mrs_string ctype = cname.substr(0,pos);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span> (ctype!= v-&gt;getType())</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        MRSWARN(<span class="stringliteral">&quot;MarSystem::addControl control type mismatch (&quot;</span> + ctype + <span class="stringliteral">&quot;!=&quot;</span> + v-&gt;getType() + <span class="stringliteral">&quot;, in &quot;</span> + <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> + <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[cname] = v;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[cname]-&gt;setMarSystem(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>[cname]-&gt;setName(cname);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="comment">//success!</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    MRSDIAG(<span class="stringliteral">&quot;MarSystem::addControl - control added successfully: &quot;</span> + cname + <span class="stringliteral">&quot; @ &quot;</span> + <a class="code" href="classMarsyas_1_1MarSystem.html#abec89a9066105205150c0bb915578f10">absPath_</a>);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;}</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;MarSystem::updctrl(<a class="code" href="classMarsyas_1_1EvEvent.html" title="EvEvent.">EvEvent</a>* me)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;{</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">if</span> (me != NULL)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        me-&gt;<a class="code" href="classMarsyas_1_1EvEvent.html#a0f109f1a95c300f1a979a9d59f2c39d4" title="the action to be performed by the event. This method is called when the event is due. Since Marsyas is not threaded, this method will block so be careful not to do too much.">dispatch</a>();</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keyword">delete</span>(me);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;}</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;MarSystem::updctrl(<a class="code" href="classMarsyas_1_1TmTime.html" title="TmTime.">TmTime</a> t, <a class="code" href="classMarsyas_1_1EvEvent.html" title="EvEvent.">EvEvent</a>* ev)</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;{</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    scheduler_.post(t,<a class="code" href="classMarsyas_1_1Repeat.html" title="encapsulates repetition information for scheduled events">Repeat</a>(),ev);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;}</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;MarSystem::updctrl(<a class="code" href="classMarsyas_1_1TmTime.html" title="TmTime.">TmTime</a> t, <a class="code" href="classMarsyas_1_1Repeat.html" title="encapsulates repetition information for scheduled events">Repeat</a> r, <a class="code" href="classMarsyas_1_1EvEvent.html" title="EvEvent.">EvEvent</a>* ev)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;{</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    scheduler_.post(t,r,ev);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;}</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;MarSystem::updctrl(<a class="code" href="classMarsyas_1_1TmTime.html" title="TmTime.">TmTime</a> t, mrs_string cname, MarControlPtr control)</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;{</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    scheduler_.post(t,<a class="code" href="classMarsyas_1_1Repeat.html" title="encapsulates repetition information for scheduled events">Repeat</a>(),<span class="keyword">new</span> <a class="code" href="classMarsyas_1_1EvValUpd.html" title="update a MarSystem control value">EvValUpd</a>(<span class="keyword">this</span>,cname,control));</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;}</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;MarSystem::updctrl(<a class="code" href="classMarsyas_1_1TmTime.html" title="TmTime.">TmTime</a> t, <a class="code" href="classMarsyas_1_1Repeat.html" title="encapsulates repetition information for scheduled events">Repeat</a> r, mrs_string cname, MarControlPtr control)</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;{</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    scheduler_.post(t,r,<span class="keyword">new</span> <a class="code" href="classMarsyas_1_1EvValUpd.html" title="update a MarSystem control value">EvValUpd</a>(<span class="keyword">this</span>,cname,control));</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;}</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;MarSystem::removeTimer(mrs_string name)</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;{</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    scheduler_.removeTimer(name);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;}</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;MarSystem::addTimer(std::string tmr_class, std::string tmr_ident)</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;{</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    scheduler_.addTimer(tmr_class,tmr_ident);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;}</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;MarSystem::addTimer(std::string tmr_class, std::string tmr_ident, std::vector&lt;TmParam&gt; params)</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;{</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    scheduler_.addTimer(tmr_class,tmr_ident,params);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;}</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;MarSystem::updtimer(std::string tmr_ctrl_path, <a class="code" href="classMarsyas_1_1TmControlValue.html" title="TmControlValue is a simple parameter passing mechanism for updtimer.">TmControlValue</a> value)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;{</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    scheduler_.updtimer(tmr_ctrl_path,value);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;}</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;MarSystem::updtimer(std::string tmr_path, <a class="code" href="classMarsyas_1_1TmParam.html" title="TmParam associates a name with a value and is used for setting parameters of timers.">TmParam</a> param)</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;{</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    scheduler_.updtimer(tmr_path,param);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;}</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;MarSystem::updtimer(std::string tmr_path, std::vector&lt;TmParam&gt; params)</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;{</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    scheduler_.updtimer(tmr_path,params);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;}</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;mrs_natural</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;MarSystem::getTime(mrs_string timer_name)</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;{</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">return</span> scheduler_.getTime(timer_name);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;}</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"><a class="code" href="classMarsyas_1_1MarSystem.html#a866bc69cc6f557ab502d49762105b5ee"> 1385</a></span>&#160;<a class="code" href="classMarsyas_1_1MarSystem.html#a866bc69cc6f557ab502d49762105b5ee" title="MATLAB scripting.">MarSystem::setMATLABscript</a>(std::string script)</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;{</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    MATLABscript_ = script;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;}</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;mrs_string</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;MarSystem::getMATLABscript()</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;{</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordflow">return</span> MATLABscript_;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;mrs_string</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;MarSystem::toStringShort()</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;{</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;  ostringstream oss;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  put(oss, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;}</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;mrs_string</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;MarSystem::toString()</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;{</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    ostringstream oss;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    put(oss,<span class="keyword">true</span>);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;mrs_string</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;MarSystem::toStringGraphViz()</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;{</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    ostringstream oss;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    ostringstream oss_defs;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    ostringstream oss_links;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    toStringGraphViz(oss_defs, oss_links);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">//oss &lt;&lt; oss_defs.str() &lt;&lt; endl;</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    oss &lt;&lt; <span class="stringliteral">&quot;digraph G {&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    oss &lt;&lt; oss_links.str();</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    oss &lt;&lt; <span class="stringliteral">&quot;}&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;}</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;MarSystem::toStringGraphViz(ostringstream&amp; oss_defs, ostringstream&amp; oss_links)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;{</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">// Print the node def.</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">//oss_defs &lt;&lt; &quot;Node=&quot; &lt;&lt; prefix_ &lt;&lt; endl;</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> a=0;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="comment">// Print the links</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordtype">int</span> sz=<a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.size();</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (sz&gt;0)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="comment">// Make a cluster.</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        oss_links &lt;&lt; <span class="stringliteral">&quot;\tsubgraph cluster_&quot;</span> &lt;&lt; a++ &lt;&lt; <span class="stringliteral">&quot; {&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        oss_links &lt;&lt; <span class="stringliteral">&quot;\t\tlabel = \&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a>  &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; endl;  </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        oss_links &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span>;    </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sz-1; ++i)</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <span class="comment">// TODO are there other composite types to handle?</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> == <span class="stringliteral">&quot;Fanout&quot;</span> || <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> == <span class="stringliteral">&quot;Parallel&quot;</span>) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;isComposite_) {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                    <span class="comment">// TODO: handle links to composites better.</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                    oss_links &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;prefix_ &lt;&lt; <span class="stringliteral">&quot;\&quot;;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                    oss_links &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;prefix_ &lt;&lt; <span class="stringliteral">&quot;\&quot;;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                <span class="keywordflow">if</span> ( <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;isComposite_) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                    <span class="comment">// TODO: handle links to composites better.</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                    oss_links &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;prefix_ &lt;&lt; <span class="stringliteral">&quot;\&quot; -&gt; &quot;</span>;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                    oss_links &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;prefix_ &lt;&lt; <span class="stringliteral">&quot;\&quot; -&gt; &quot;</span>;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            }   </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        oss_links &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[sz-1]-&gt;prefix_ &lt;&lt; <span class="stringliteral">&quot;\&quot;;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        oss_links &lt;&lt; <span class="stringliteral">&quot;\t}&quot;</span> &lt;&lt; endl &lt;&lt; endl; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="comment">// Link to start.</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="comment">// TODO are there other composite types to handle?</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> == <span class="stringliteral">&quot;Fanout&quot;</span> || <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> == <span class="stringliteral">&quot;Parallel&quot;</span>) {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <span class="comment">// Link to all first items for parallel types of composites.</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;sz; ++j)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                oss_links &lt;&lt; <span class="stringliteral">&quot;\t\&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; -&gt; \&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[j]-&gt;<a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> &lt;&lt; <span class="stringliteral">&quot;\&quot;;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="comment">// Only link to first item in series.</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            oss_links &lt;&lt; <span class="stringliteral">&quot;\t\&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#aee2268e08f3b7f390308ac90e9e87e74" title="/type_/name_/">prefix_</a> &lt;&lt; <span class="stringliteral">&quot;\&quot; -&gt; \&quot;&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[0]-&gt;prefix_ &lt;&lt; <span class="stringliteral">&quot;\&quot;;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <span class="comment">// Link the end of series back to parent&#39;s next item... tricky.</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        <span class="comment">// TODO</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="comment">// Children.</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">if</span> (sz&gt;0)</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sz; ++i)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;toStringGraphViz(oss_defs, oss_links);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;}</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<a class="code" href="classMarsyas_1_1marostring.html" title="abstract class for Marsyas Network string representation generators">marostring</a>&amp;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;MarSystem::toString(<a class="code" href="classMarsyas_1_1marostring.html" title="abstract class for Marsyas Network string representation generators">marostring</a>&amp; m)</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;{</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    m.begin_marsystem(isComposite_, getType(), getName());</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    m.begin_controls(<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.size());</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="keywordflow">for</span> (ctrlIter_ = <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.begin(); ctrlIter_ != <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end(); ++ctrlIter_)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        MarControlPtr <a class="code" href="classMarsyas_1_1MarSystem.html#abe8561cc60ffe3e07225be25849c61aa" title="observation and time index //[!]">c</a> = ctrlIter_-&gt;second;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        std::ostringstream cv;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        cv &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#abe8561cc60ffe3e07225be25849c61aa" title="observation and time index //[!]">c</a>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        std::string ct = c-&gt;getType();</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        std::string cn = c-&gt;getName();</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="comment">// get the trailing bit after / Don&#39;t know why name is now type/name</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keywordtype">int</span> lp = (int)cn.find_last_of(<span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keywordflow">if</span> (lp &gt;= 0 &amp;&amp; (lp+1) &lt; (<span class="keywordtype">int</span>)cn.size())</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            cn = cn.substr(lp+1);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keywordtype">bool</span> cs = c-&gt;hasState();</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        m.begin_control(ct, cn, cv.str(), cs);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        std::vector&lt;std::pair&lt;MarControlPtr, MarControlPtr&gt; &gt; links = c-&gt;getLinks();</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt; (mrs_natural)links.size(); ++i)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="comment">//check who is linking to this control, but avoid outputting root link info</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            <span class="keywordflow">if</span> (c == links[i].second() &amp;&amp; links[i].first() != <a class="code" href="classMarsyas_1_1MarSystem.html#abe8561cc60ffe3e07225be25849c61aa" title="observation and time index //[!]">c</a>)</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                j++;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            }</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        m.begin_control_links_in(j);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;(mrs_natural)links.size(); ++i)</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <span class="comment">// check who is linking to this control, but avoid outputting root link info</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="keywordflow">if</span> (c == links[i].second() &amp;&amp; links[i].first() != <a class="code" href="classMarsyas_1_1MarSystem.html#abe8561cc60ffe3e07225be25849c61aa" title="observation and time index //[!]">c</a>)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                m.put_control_link_in(links[i].first-&gt;getMarSystem()-&gt;getAbsPath(),links[i].first-&gt;getType(),links[i].first-&gt;getName());</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        m.end_control_links_in(j);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;(mrs_natural)links.size(); ++i)</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <span class="comment">//check where to this control is linking, but avoid outputting root link info</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;            <span class="keywordflow">if</span> (c == links[i].first() &amp;&amp; c != links[i].second())</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                j++;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        m.begin_control_links_out(j);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;(mrs_natural)links.size(); ++i)</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <span class="comment">//check where to this control is linking, but avoid outputting root link info</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="keywordflow">if</span> (c == links[i].first() &amp;&amp; c != links[i].second())</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                m.put_control_link_out(links[i].second-&gt;getMarSystem()-&gt;getAbsPath(),links[i].second-&gt;getType(),links[i].second-&gt;getName());</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            }</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        m.end_control_links_out(j);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        m.end_control(ct, cn, cv.str(), cs);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    m.end_controls(<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.size());</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordtype">int</span> sz=<a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.size();</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">if</span> (sz&gt;0)</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        m.begin_children(sz);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sz; ++i)</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        {</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;toString(m);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        m.end_children(sz);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    }</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    m.end_marsystem(isComposite_, getType(), getName());</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordflow">return</span> m;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;}</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment">// write *this to s</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;ostream&amp;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;MarSystem::put(ostream &amp;o, <span class="keywordtype">bool</span> verbose)</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;{</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;# MarSystemComposite&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;# MarSystem&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;# Type = &quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;# Name = &quot;</span> &lt;&lt; name_ &lt;&lt; endl;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    o &lt;&lt; endl;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      o &lt;&lt; <span class="stringliteral">&quot;# MarControls = &quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">for</span> (ctrlIter_=<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.begin(); ctrlIter_ != <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end(); ++ctrlIter_)</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        ostringstream toss;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        toss &lt;&lt; ctrlIter_-&gt;second;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <span class="keywordflow">if</span> (toss.str() != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          o &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; ctrlIter_-&gt;first &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; ctrlIter_-&gt;second &lt;&lt; endl;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          o &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; ctrlIter_-&gt;first &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <span class="stringliteral">&quot;MARSYAS_EMPTYSTRING&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        <span class="comment">//serialize links</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        ostringstream oss;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        std::vector&lt;std::pair&lt;MarControlPtr, MarControlPtr&gt; &gt; links = ctrlIter_-&gt;second-&gt;getLinks();</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        mrs_natural numLinks = 0;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="comment">//links to:</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;(mrs_natural)links.size(); ++i)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            <span class="comment">//check where to this control is linking, but avoid outputting root link info</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="keywordflow">if</span> (ctrlIter_-&gt;second() == links[i].first() &amp;&amp; links[i].first() != links[i].second())</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                oss &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; links[i].second-&gt;getMarSystem()-&gt;getAbsPath() &lt;&lt; links[i].second-&gt;getName() &lt;&lt; endl;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                numLinks++;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;# LinksTo = &quot;</span> &lt;&lt; numLinks &lt;&lt; endl &lt;&lt; oss.str();</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="comment">//linked from:</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        numLinks = 0;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        oss.str(<span class="stringliteral">&quot;&quot;</span>); <span class="comment">//clear the stringstream</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;(mrs_natural)links.size(); ++i)</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            <span class="comment">//check who is linking to this control, but avoid outputting root link info</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;            <span class="keywordflow">if</span> (ctrlIter_-&gt;second() == links[i].second() &amp;&amp; links[i].first() != links[i].second())</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                oss &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; links[i].first-&gt;getMarSystem()-&gt;getAbsPath() &lt;&lt; links[i].first-&gt;getName() &lt;&lt; endl;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                numLinks++;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;# LinkedFrom = &quot;</span> &lt;&lt; numLinks &lt;&lt; endl &lt;&lt; oss.str();</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      }</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        o &lt;&lt; endl;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;# nComponents = &quot;</span> &lt;&lt; marsystemsSize_ &lt;&lt; endl;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        o &lt;&lt; endl;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i &lt; marsystemsSize_; ++i)</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;          <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i]-&gt;put(o,verbose);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    }</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;}</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">// Output the MarSystem to stdout as a HTML document, with</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">// collapsible elements provided by a Javascript function</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;ostream&amp;</div>
<div class="line"><a name="l01656"></a><span class="lineno"><a class="code" href="classMarsyas_1_1MarSystem.html#aebbabcf1e6fde50604e431e768c396e7"> 1656</a></span>&#160;<a class="code" href="classMarsyas_1_1MarSystem.html#aebbabcf1e6fde50604e431e768c396e7" title="Output the MarSystem as an HTML document with nested lists.">MarSystem::put_html</a>(ostream &amp;o)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;{</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">// Output the HTML header</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="comment">// sness - Add proper DOCTYPE later</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;script type=\&quot;text/javascript\&quot; src=\&quot;http://assets.sness.net/simpletreemenu.js\&quot;&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;/script&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;link rel=\&quot;stylesheet\&quot; type=\&quot;text/css\&quot; href=\&quot;http://assets.sness.net/simpletree.css\&quot; /&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;a href=\&quot;javascript:ddtreemenu.flatten(\&#39;treemenu1\&#39;, \&#39;expand\&#39;)\&quot;&gt;Expand All&lt;/a&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;a href=\&quot;javascript:ddtreemenu.flatten(\&#39;treemenu1\&#39;, \&#39;contact\&#39;)\&quot;&gt;Contact All&lt;/a&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;ul id=\&quot;treemenu1\&quot; class=\&quot;treeview\&quot;&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    put_html_worker(o);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="comment">// Output the HTML footer</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;script type=\&quot;text/javascript\&quot;&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;ddtreemenu.createTree(\&quot;treemenu1\&quot;, true)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;/script&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;}</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment">// Output a single MarSystem to &amp;o, without HTML headers and footers</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;ostream&amp;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;MarSystem::put_html_worker(ostream &amp;o)</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;{</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;MarSystemComposite&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    {</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;MarSystem&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;Type = &quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a82430191e59707c01706b4dcddde965a" title="Type of MarSystem.">type_</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;Name = &quot;</span> &lt;&lt; name_ &lt;&lt; endl;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    o &lt;&lt; endl;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;MarControls&quot;</span> &lt;&lt; <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;ul&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">for</span> (ctrlIter_=<a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.begin(); ctrlIter_ != <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end(); ++ctrlIter_)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        ostringstream toss;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        toss &lt;&lt; ctrlIter_-&gt;second;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordflow">if</span> (toss.str() != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            o &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;&quot;</span> &lt;&lt; ctrlIter_-&gt;first &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; ctrlIter_-&gt;second &lt;&lt; <span class="stringliteral">&quot;&lt;/li&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            o &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;&quot;</span> &lt;&lt; ctrlIter_-&gt;first &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <span class="stringliteral">&quot;MARSYAS_EMPTYSTRING&quot;</span> &lt;&lt; <span class="stringliteral">&quot;&lt;/li&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="comment">//serialize links</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        ostringstream oss;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        std::vector&lt;std::pair&lt;MarControlPtr, MarControlPtr&gt; &gt; links = ctrlIter_-&gt;second-&gt;getLinks();</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        mrs_natural numLinks = 0;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="comment">// Links To:</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;(mrs_natural)links.size(); ++i)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            <span class="comment">//check where to this control is linking, but avoid outputting root link info</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            <span class="keywordflow">if</span> (ctrlIter_-&gt;second() == links[i].first() &amp;&amp; links[i].first() != links[i].second())</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                oss &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;&quot;</span> &lt;&lt; links[i].second-&gt;getMarSystem()-&gt;getAbsPath() &lt;&lt; links[i].second-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;&lt;/li&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                numLinks++;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keywordflow">if</span> (numLinks &gt; 0)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            o &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;LinksTo = &quot;</span> &lt;&lt; numLinks &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;&lt;ul&gt;&quot;</span> &lt;&lt; oss.str() &lt;&lt; <span class="stringliteral">&quot;&lt;/ul&gt;&lt;/li&gt;&quot;</span>;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="comment">// Linked From:</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        numLinks = 0;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        oss.str(<span class="stringliteral">&quot;&quot;</span>); <span class="comment">//clear the stringstream</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt;(mrs_natural)links.size(); ++i)</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            <span class="comment">//check who is linking to this control, but avoid outputting root link info</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            <span class="keywordflow">if</span> (ctrlIter_-&gt;second() == links[i].second() &amp;&amp; links[i].first() != links[i].second())</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                oss &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;&quot;</span> &lt;&lt; links[i].first-&gt;getMarSystem()-&gt;getAbsPath() &lt;&lt; links[i].first-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;&lt;/li&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                numLinks++;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keywordflow">if</span> (numLinks &gt; 0)</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            o &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;LinkedFrom = &quot;</span> &lt;&lt; numLinks &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;&lt;ul&gt;&quot;</span> &lt;&lt; oss.str() &lt;&lt; <span class="stringliteral">&quot;&lt;/ul&gt;&lt;/li&gt;&quot;</span>;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;/ul&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;/li&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        o &lt;&lt; endl;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;&lt;li&gt;Components = &quot;</span> &lt;&lt; marsystemsSize_ &lt;&lt; endl;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;&lt;ul&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i &lt; marsystemsSize_; ++i)</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            (<a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i])-&gt;put_html_worker(o);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;&lt;/ul&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;&lt;/li&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    }</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;&lt;/li&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;}</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;istream&amp;</div>
<div class="line"><a name="l01771"></a><span class="lineno"><a class="code" href="classMarsyas_1_1MarSystem.html#ae3bf89f6a267e930ec5d3e768ccfad22"> 1771</a></span>&#160;MarSystem::put(istream&amp; is)</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;{</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="comment">/* This method assumes that the input stream is in the format</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">     * generated by MarSystem::put(ostream&amp; o).</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">     * This is also known as &quot;.mpl file format&quot;.</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">     * This method also assumes that it is being called by</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment">     * MarSystemManager::getMarSystem(std::istream&amp; is, MarSystem *parent)</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">     * and thus the input has its header data (first 4 lines) stripped off already</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    mrs_string skipstr;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    mrs_natural i;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    mrs_string type;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    mrs_string rstr = <span class="stringliteral">&quot;mrs_real&quot;</span>;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    mrs_string nstr = <span class="stringliteral">&quot;mrs_natural&quot;</span>;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    mrs_string bstr = <span class="stringliteral">&quot;mrs_bool&quot;</span>;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    mrs_string sstr = <span class="stringliteral">&quot;mrs_string&quot;</span>;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    mrs_string vstr = <span class="stringliteral">&quot;mrs_realvec&quot;</span>;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    mrs_real   rcvalue;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    mrs_string scvalue;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    mrs_natural ncvalue;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordtype">bool</span> bcvalue;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    mrs_string cname;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    map&lt;mrs_string, MarControlPtr&gt;::iterator iter;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="comment">// if composite, clear all children to avoid bad links to prototype children</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keywordflow">if</span> (isComposite_)</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    {</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        <span class="keywordflow">for</span> (mrs_natural i=0; i&lt; marsystemsSize_; ++i)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <span class="keyword">delete</span> <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>[i];</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <a class="code" href="classMarsyas_1_1MarSystem.html#a9f8e8d9c30975788bb7aa6b958a57e76" title="children">marsystems_</a>.clear();</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        marsystemsSize_ = 0;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="comment">// Start reading!</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">/* The first line should look something like:</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">     * # MarControls = 19</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment">     * we want to skip everything up to the 19 (or whatever number it is)</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    is &gt;&gt; skipstr &gt;&gt; skipstr &gt;&gt; skipstr;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    mrs_natural nControls;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    is &gt;&gt; nControls;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="keywordflow">for</span> (i=0; i &lt; nControls; ++i)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="comment">/* For each control there are at least three lines:</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment">         * # ctrlname = ctrlvalue</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment">         * # LinksTo = nLinks</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">         * # LinkedFrom = nLinks</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment">         * First, we get the cname and, from it, extract the type:</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        is &gt;&gt; skipstr;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        is &gt;&gt; cname;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        mrs_string ctype;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        ctype = cname.substr(0, cname.rfind(<span class="stringliteral">&quot;/&quot;</span>, cname.length()));</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        iter = <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.find(cname);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        is &gt;&gt; skipstr;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <span class="comment">// Now, based on the type, we extract the value</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <span class="keywordflow">if</span> (ctype == rstr)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        {</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            is &gt;&gt; rcvalue;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="keywordflow">if</span> (iter == <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end())</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                addControl(cname, rcvalue);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                updControl(cname, rcvalue);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctype == sstr)</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            getline(is, scvalue);  <span class="comment">// getline is used to include spaces in strings</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            scvalue = scvalue.substr(1, scvalue.length()); <span class="comment">// strip leading space</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;            <span class="keywordflow">if</span> (scvalue == <span class="stringliteral">&quot;MARSYAS_EMPTYSTRING&quot;</span>)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                scvalue = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            <span class="keywordflow">if</span> (iter == <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end())</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                addControl(cname, scvalue);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                updControl(cname, scvalue);</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctype == nstr)</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            is &gt;&gt; ncvalue;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            <span class="keywordflow">if</span> (iter == <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end())</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                addControl(cname, ncvalue);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                updControl(cname, ncvalue);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctype == bstr)</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            is &gt;&gt; bcvalue;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            <span class="keywordflow">if</span> (iter == <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end())</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                addControl(cname, bcvalue);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                updControl(cname, bcvalue);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctype == vstr)</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        {</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            realvec vcvalue;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            is &gt;&gt; vcvalue;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            <span class="keywordflow">if</span> (iter == <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end())</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                addControl(cname, vcvalue);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                updControl(cname, vcvalue);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        }</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            <span class="comment">// if the ctype wasn&#39;t recognized as a base type</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            <span class="comment">// it&#39;s a control type. add a new control pointer</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;            MarControlPtr ctrl = MarControlManager::getManager()-&gt;createFromStream(ctype, is);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            <span class="keywordflow">if</span> (iter == <a class="code" href="classMarsyas_1_1MarSystem.html#a56e3cc39df41d7723fe9c427e78d9100" title="Controls.">controls_</a>.end())</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                addControl(cname, ctrl);</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                updControl(cname, ctrl);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        }</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">         * Now we read in the LinksTo and LinksFrom lines</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        <span class="comment">//clean all links for current control (if any)</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        MarControlPtr curCtrl = getControlLocal(cname);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        curCtrl-&gt;unlinkFromAll();</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        <span class="comment">// read links</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <span class="keywordtype">int</span> nLinks;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        mrs_string linkto;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        mrs_string linkedfrom;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="comment">// Next line looks like:</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="comment">//# LinksTo = nlinks</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        is &gt;&gt; skipstr &gt;&gt; skipstr &gt;&gt; skipstr;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        is &gt;&gt; nLinks;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        <span class="comment">//relink</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordflow">if</span> (nLinks &gt; 0)</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        {</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;            <span class="comment">//read link absolute path</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;            is &gt;&gt; skipstr &gt;&gt; linkto;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;            <a class="code" href="classMarsyas_1_1MarSystem.html#a63f09b80ca0e7838eb2a771e0372afec" title="Link controls.">linkControl</a>(cname, linkto);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        }</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        <span class="comment">// Next line looks like:</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <span class="comment">//# LinksFrom = nlinks</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        is &gt;&gt; skipstr &gt;&gt; skipstr &gt;&gt; skipstr;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        is &gt;&gt; nLinks;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="comment">//relink</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="comment">/* If there are any LinksFrom, there will be one line for each.</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">         * those lines look like:</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment">         * # /Series/net/Classifier/cl/ZeroRClassifier/zerorcl/mrs_natural/nClasses</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment">         * ie. hash sign, followed by a path</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keywordflow">for</span> (mrs_natural link=0; link &lt; nLinks; ++link)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;            <span class="comment">//read link absolute path</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            is &gt;&gt; skipstr;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            is &gt;&gt; linkedfrom;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            <span class="comment">//look for control in the entire network</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            MarControlPtr ctrl = getControl(linkedfrom, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            <span class="comment">//if found, just link it to this control.</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            <span class="comment">//if not, this link will be done when the sibling or child MarSystem</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            <span class="comment">//owning the missing control is created</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            <span class="keywordflow">if</span> (!ctrl.isInvalid())</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            {</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                <span class="comment">//ctrl-&gt;getMarSystem()-&gt;linkControl(linkedfrom, cname);</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                ctrl-&gt;linkTo(curCtrl);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            }</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        }</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordflow">return</span> is;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;}</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;ostream&amp;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;Marsyas::operator&lt;&lt; (ostream&amp; o, <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>&amp; sys)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;{</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  sys.put(o, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;}</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;istream&amp;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;Marsyas::operator&gt;&gt; (istream&amp; is, <a class="code" href="classMarsyas_1_1MarSystem.html" title="MarSystem transforms a realvec.">MarSystem</a>&amp; sys)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;{</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    sys.put(is);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">return</span> is;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;}</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;ostream&amp;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;Marsyas::operator&lt;&lt; (ostream&amp; o, const map&lt;mrs_string,MarControlPtr&gt;&amp; c)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;{</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="comment">//lock map&lt;mrs_string,MarControlPtr&gt;&amp; c for read? [?]</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    o &lt;&lt; <span class="stringliteral">&quot;# MarControls = &quot;</span> &lt;&lt; c.size() &lt;&lt; endl;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    map&lt;mrs_string, MarControlPtr&gt;::const_iterator iter;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">for</span> (iter=c.begin(); iter != c.end(); ++iter)</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        o &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; iter-&gt;first &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; iter-&gt;second &lt;&lt; endl;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordflow">return</span> o;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;}</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;mrs_string</div>
<div class="line"><a name="l01996"></a><span class="lineno"><a class="code" href="group__String.html#ga9de1c6e5822eb1288abf614b7bb42543"> 1996</a></span>&#160;<a class="code" href="group__String.html#ga9de1c6e5822eb1288abf614b7bb42543" title="Helper function for adding a prefix to each of the observation names.">Marsyas::obsNamesAddPrefix</a>(mrs_string observationNames, mrs_string prefix)</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;{</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    ostringstream oss;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    mrs_string::size_type startPos = 0, endPos=0;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">while</span> ((endPos = observationNames.find(<span class="stringliteral">&quot;,&quot;</span>, startPos)) != mrs_string::npos)</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="comment">// Extract the observation name.</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        mrs_string name = observationNames.substr(startPos, endPos-startPos);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        oss &lt;&lt; prefix &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="comment">// Update the start position for the next name.</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        startPos = endPos + 1;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;}</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;vector&lt;mrs_string&gt;</div>
<div class="line"><a name="l02030"></a><span class="lineno"><a class="code" href="group__String.html#ga1953768606e74ccbbc595e5d70d69c93"> 2030</a></span>&#160;<a class="code" href="group__String.html#ga1953768606e74ccbbc595e5d70d69c93" title="Helper function for splitting a string.">Marsyas::stringSplit</a>(mrs_string input, mrs_string delimiter)</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;{</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    vector&lt;mrs_string&gt; itemList;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;    mrs_string::size_type startPos = 0, endPos=0;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="comment">// Keep searching for the delimiter.</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="keywordflow">while</span> ((endPos = input.find(delimiter, startPos)) != mrs_string::npos)</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        <span class="comment">// Get the current item.</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        mrs_string item = input.substr(startPos, endPos - startPos);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <span class="comment">// Store it</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        itemList.push_back(item);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="comment">// Update the start position for the next name.</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        startPos = endPos + delimiter.size();</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="comment">// And the last item</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    itemList.push_back(input.substr(startPos, input.size() - startPos));</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="keywordflow">return</span> itemList;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;}</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;vector&lt;mrs_string&gt;</div>
<div class="line"><a name="l02066"></a><span class="lineno"><a class="code" href="group__String.html#ga37058a29eb873fbf06360cb59d744455"> 2066</a></span>&#160;<a class="code" href="group__String.html#ga37058a29eb873fbf06360cb59d744455" title="Helper function for splitting an observation name string.">Marsyas::obsNamesSplit</a>(mrs_string observationNames)</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;{</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    vector&lt;mrs_string&gt; obsNames = <a class="code" href="group__String.html#ga1953768606e74ccbbc595e5d70d69c93" title="Helper function for splitting a string.">stringSplit</a>(observationNames, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    obsNames.pop_back();</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">return</span> obsNames;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Mar 24 2013 13:57:20 for Marsyas by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
